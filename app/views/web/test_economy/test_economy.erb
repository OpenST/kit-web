<%
  bt_symbol = @presenter_obj.client_token_symbol
  activate_test_economy_api_route =  GlobalConstant::RoutesMap.getApis()[:api_activate_test_economy]
  api_invite_to_test_economy = GlobalConstant::RoutesMap.getApis()[:api_invite_to_test_economy]
  has_setup_test_economy = @presenter_obj.client.has_setup_test_economy?
  qr_code_url = @presenter_obj.test_economy_details.qr_code_url
  manager_email = @presenter_obj.manager.email
%>

<div class="test-economy-container mb-6">

  <div class="test-economy-post-setup" style="display: <%= has_setup_test_economy ? 'block': 'none'%>">
    <h3 class="text-center mt-5"> Setup Test Wallet </h3>
    <div class="row">
      <div class="col-9 mx-auto mt-2 font-weight-light text-muted text-center">
        <p>To see what is possible with the OST SDKs, <br/>connect your Brand Token to our Demo App.</p>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-9 shadow-box mx-auto p-4">
        <svg class="success-icon align-middle d-inline" style="width: 34px; height: 34px">
          <switch>
            <use class="success-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#success-icon"></use>
          </switch>
        </svg>
        <p class="mb-0 font-weight-light text-muted d-inline align-middle ml-2">The servers for the <%=bt_symbol%> Test economy have been deployed.</p>
      </div>
    </div>
    <div class="row mt-4">
      <div class="col-9 mx-auto shadow-box px-0 mb-6">
        <div class="card">
          <h3 class="card-header">Send App Invites</h3>
          <div class="card-body">
            <p class="font-weight-light text-muted">Invite your colleagues to join you in the OST Wallet test app.
              You will be able to easily send tokens to each other, view transactions on the blockchain, and explore all of the wallet
              security features.</p>
            <div class="send-invite-section">
              <div class="row">
                <div class="col-7">
                  <form id="invite-economy-form" class="user-form" data-submiting="Sending…" action="<%= api_invite_to_test_economy %>" method="POST">
                    <div class="form-group">
                      <label for="user_email" class="form-label text-uppercase">Email Address</label>
                      <input type="text" id="set-up-email-address"
                             pattern="^([\w+-.%]+@[\w-.]+\.[A-Za-z]{2,4},*[\W]*)+$"
                             title="Email"
                             data-msg-pattern="Email is invalid."
                             class="form-control" id="email_addresses" name="email_addresses"
                             placeholder="Email Addresses" required autofocus/>
                      <div class="invalid-feedback" data-forid="email_addresses">&nbsp;</div>
                      <button type="submit" data-submiting="sending.." id="send-invite-btn" class="btn btn-primary mt-2">
                        SEND INVITE
                      </button>
                    </div>
                    <div class="general_error invalid-feedback" data-forid="invite-economy-form">&nbsp;</div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-economy-pre-setup mt-2" style="display: <%= !has_setup_test_economy ? 'block': 'none'%>">
    <h3 class="text-center mt-5"> Wallet </h3>
    <div class="row">
      <div class="col-9 mx-auto px-3 mt-3 font-weight-light text-muted text-center">
        <p>Now that your economy is setup, we recommend running some test transactions in the OST Wallet.
          This will give you and your team a feel for the potential before starting integration with your apps and website.
          If you have any questions at any time, please reach out to us at <a>support@ost.com</a>
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-9 mx-auto shadow-box px-0">
        <form id="launch-setup-form" action="<%= activate_test_economy_api_route %>" method="POST">
          <div class="card">
            <h3 class="card-header">Setup Test Wallet</h3>
            <div class="card-body">
              <p class="font-weight-light text-muted">This step will create your token economy in the OST Wallet test app.
                You and your team members will be able to download the test app on iOS and Android, run test transactions,
                and explore the wallet security features.
              </p>
              <button type="submit" id="launch-test-economy" data-submiting="Setting up.." class="btn btn-primary">
                SETUP WALLET
              </button>
              <div class="invalid-feedback" data-forid="launch-test-economy">&nbsp;</div>
              <div class="general_error invalid-feedback"></div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="test-economy-setup mt-6" style="display: none">
    <div class="row">
      <div class="col-8 mx-auto px-0 text-center">
        <svg class="mb-3 mt-4" style="height: 60px;width: 62px;">
          <switch>
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#email-icon"></use>
          </switch>
        </svg>
        <h3>OST Wallet Setup Complete!</h3>
        <p class="font-weight-light w-75 mx-auto mt-3 mb-5">Your token economy has been successfully setup in the OST Wallet app.
          An invite has been sent to frankie@ost.com.
          Now invite your colleagues so you can send and receive tokens with each other.</p>
        <a href="javascript:void(0)" class="invite-users-btn btn btn-primary" title="Invite Users">INVITE USERS</a>
      </div>
    </div>
  </div>

  <div class="invite-successful mt-6" style="display: none">
    <div class="row">
      <div class="col-8 mx-auto px-0 text-center">
        <svg class="mb-3 mt-4" style="height: 60px;width: 62px;">
          <switch>
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#email-icon"></use>
          </switch>
        </svg>
        <h3>Invites have been sent!</h3>
        <p class="font-weight-light w-75 mx-auto mt-3 mb-5">You’ll be able test token transfers to the invited users once they’ve downloaded the app and joined the <%= bt_symbol %> demo economy.</p>
        <a href="" class="invite-more-users-btn btn btn-primary" title="Invite More Users">INVITE More USERS</a>
      </div>
    </div>
  </div>

</div>

<% content_for :end_js do %>
  <script type="text/javascript">
    $(function () {
      ost.test_economy.init();
    });
  </script>
<% end %>